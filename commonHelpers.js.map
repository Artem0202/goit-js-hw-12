{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('form');\nconst photosList = document.querySelector('ul');\nconst loadMoreButton = document.querySelector('.button-load-more');\nlet page = 1;\nlet perPage = 15;\nlet inputContent;\nlet totalHits;\nlet totalPages;\n\nconst louder = `<div class=\"loader\"></div>`;\nphotosList.insertAdjacentHTML('afterend', louder);\nconst loaderBox = document.querySelector('.loader');\n\nform.addEventListener('submit', searchImages);\n\nasync function searchImages(event) {\n  try {\n    event.preventDefault();\n    page = 1;\n    photosList.innerHTML = '';\n    loadMoreButton.style.display = 'none';\n    loaderBox.style.display = 'block';\n\n    inputContent = event.currentTarget.text.value.trim();\n    if (inputContent === '') {\n      return iziToast.info({\n        title: 'Attention',\n        message: 'Please enter a request',\n      });\n    }\n\n    const photos = await fetchPhotos();\n    fetchThen(photos);\n    loadMoreButton.addEventListener('click', searchMoreImages);\n  } catch (error) {\n    console.log(error);\n  }\n}\nconst fetchPhotos = async () => {\n  const response = await axios.get(`https://pixabay.com/api/`, {\n    params: {\n      key: '42277642-5b5e0c3e2383e813180f7c1aa',\n      q: inputContent,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: perPage,\n      page: page,\n    },\n  });\n  return response.data;\n};\n\nfunction fetchThen(photos) {\n  const markupGalleryPhotos = photos.hits\n    .map(photo => {\n      return `\n        <li class=\"gallery-item\">\n          <a href=\"${photo.largeImageURL}\">\n          <img src=\"${photo.webformatURL}\" alt=\"${photo.tags}\">\n          <ul class=\"photo-info\">\n            <li>\n                <h3>Likes</h3>\n                <p>${photo.likes}</p>\n            </li>\n            <li>\n                <h3>Views</h3>\n                <p>${photo.views}</p>\n            </li>\n            <li>\n                <h3>Comments</h3>\n                <p>${photo.comments}</p>\n            </li>\n            <li>\n                <h3>Downloads</h3>\n                <p>${photo.downloads}</p>\n            </li>\n          </ul>\n          </a>\n        </li>\n      `;\n    })\n    .join('');\n\n  setTimeout(() => {\n    loaderBox.style.display = 'none';\n    if (photos.totalHits === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    photosList.insertAdjacentHTML('beforeend', markupGalleryPhotos);\n    const galleryItem = document.querySelector('.gallery-item');\n    let sizesGalleryBox = galleryItem.getBoundingClientRect();\n    window.scrollBy({\n      top: sizesGalleryBox.width * 2,\n      behavior: 'smooth',\n    });\n\n    loadMoreButton.style.display = 'inline-block';\n\n    let lightbox = new SimpleLightbox('.gallery-list a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    totalHits = photos.totalHits;\n    totalPages = Math.ceil(totalHits / perPage);\n    if (page >= totalPages) {\n      loadMoreButton.style.display = 'none';\n\n      return iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }, 1000);\n}\n\nasync function searchMoreImages() {\n  try {\n    page += 1;\n    loadMoreButton.style.display = 'none';\n    loaderBox.style.display = 'block';\n    const photos = await fetchPhotos();\n    fetchThen(photos);\n  } catch (error) {\n    console.log(error);\n  }\n}\n"],"names":["form","photosList","loadMoreButton","page","perPage","inputContent","totalHits","totalPages","louder","loaderBox","searchImages","event","iziToast","photos","fetchPhotos","fetchThen","searchMoreImages","error","axios","markupGalleryPhotos","photo","sizesGalleryBox","SimpleLightbox"],"mappings":"owBAOA,MAAMA,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAa,SAAS,cAAc,IAAI,EACxCC,EAAiB,SAAS,cAAc,mBAAmB,EACjE,IAAIC,EAAO,EACPC,EAAU,GACVC,EACAC,EACAC,EAEJ,MAAMC,EAAS,6BACfP,EAAW,mBAAmB,WAAYO,CAAM,EAChD,MAAMC,EAAY,SAAS,cAAc,SAAS,EAElDT,EAAK,iBAAiB,SAAUU,CAAY,EAE5C,eAAeA,EAAaC,EAAO,CACjC,GAAI,CAQF,GAPAA,EAAM,eAAc,EACpBR,EAAO,EACPF,EAAW,UAAY,GACvBC,EAAe,MAAM,QAAU,OAC/BO,EAAU,MAAM,QAAU,QAE1BJ,EAAeM,EAAM,cAAc,KAAK,MAAM,KAAI,EAC9CN,IAAiB,GACnB,OAAOO,EAAS,KAAK,CACnB,MAAO,YACP,QAAS,wBACjB,CAAO,EAGH,MAAMC,EAAS,MAAMC,IACrBC,EAAUF,CAAM,EAChBX,EAAe,iBAAiB,QAASc,CAAgB,CAC1D,OAAQC,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACH,CACA,MAAMH,EAAc,UACD,MAAMI,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAK,qCACL,EAAGb,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUD,EACV,KAAMD,CACP,CACL,CAAG,GACe,KAGlB,SAASY,EAAUF,EAAQ,CACzB,MAAMM,EAAsBN,EAAO,KAChC,IAAIO,GACI;AAAA;AAAA,qBAEQA,EAAM,aAAa;AAAA,sBAClBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,qBAIvCA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,qBAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,qBAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,qBAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,OAM/B,EACA,KAAK,EAAE,EAEV,WAAW,IAAM,CAEf,GADAX,EAAU,MAAM,QAAU,OACtBI,EAAO,YAAc,EAAG,CAC1BD,EAAS,MAAM,CACb,MAAO,QACP,QACE,0EACV,CAAO,EACD,MACD,CAEDX,EAAW,mBAAmB,YAAakB,CAAmB,EAE9D,IAAIE,EADgB,SAAS,cAAc,eAAe,EACxB,wBAgBlC,GAfA,OAAO,SAAS,CACd,IAAKA,EAAgB,MAAQ,EAC7B,SAAU,QAChB,CAAK,EAEDnB,EAAe,MAAM,QAAU,eAEhB,IAAIoB,EAAe,kBAAmB,CACnD,aAAc,MACd,aAAc,GACpB,CAAK,EACQ,QAAO,EAEhBhB,EAAYO,EAAO,UACnBN,EAAa,KAAK,KAAKD,EAAYF,CAAO,EACtCD,GAAQI,EACV,OAAAL,EAAe,MAAM,QAAU,OAExBU,EAAS,KAAK,CACnB,SAAU,WACV,QAAS,4DACjB,CAAO,CAEJ,EAAE,GAAI,CACT,CAEA,eAAeI,GAAmB,CAChC,GAAI,CACFb,GAAQ,EACRD,EAAe,MAAM,QAAU,OAC/BO,EAAU,MAAM,QAAU,QAC1B,MAAMI,EAAS,MAAMC,IACrBC,EAAUF,CAAM,CACjB,OAAQI,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACH"}